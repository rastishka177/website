<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src 'self' data: https:; script-src 'self' 'unsafe-inline' https://api-maps.yandex.ru; style-src 'self' 'unsafe-inline'; connect-src 'self' https://api-maps.yandex.ru">
    <title>–ú–µ—Ç–∞–ª–ª–ü—Ä–æ–∫–∞—Ç - –ü—Ä–æ–¥–∞–∂–∞ –º–µ—Ç–∞–ª–ª–æ–ø—Ä–æ–∫–∞—Ç–∞</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>–ú–µ—Ç–∞–ª–ª–ü—Ä–æ–∫–∞—Ç</h1>
        <p>–ü—Ä–æ–¥–∞–∂–∞ –º–µ—Ç–∞–ª–ª–æ–ø—Ä–æ–∫–∞—Ç–∞ –æ–ø—Ç–æ–º –∏ –≤ —Ä–æ–∑–Ω–∏—Ü—É</p>
        <button class="cart-btn" id="cartButton">
            üõí
            <span class="cart-count" id="cartCount">0</span>
        </button>
    </header>

    <nav>
        <ul>
            <li><a href="#products">–ö–∞—Ç–∞–ª–æ–≥</a></li>
            <li><a href="#about">–û –∫–æ–º–ø–∞–Ω–∏–∏</a></li>
            <li><a href="#contacts">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
        </ul>
    </nav>

    <div class="container">
        <section id="products">
            <h2>–ù–∞—à –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç</h2>
            <div class="products">
                <!-- –¢–æ–≤–∞—Ä 1 -->
                <div class="product-card">
                    <div class="product-image">
                        <img src="https://via.placeholder.com/300x200?text=–ê—Ä–º–∞—Ç—É—Ä–∞+A500" alt="–ê—Ä–º–∞—Ç—É—Ä–∞ A500">
                    </div>
                    <div class="product-info">
                        <h3 class="product-title">–ê—Ä–º–∞—Ç—É—Ä–∞ A500</h3>
                        <p>–î–∏–∞–º–µ—Ç—Ä: 10-32 –º–º</p>
                        <p class="product-stock">–í –Ω–∞–ª–∏—á–∏–∏: 125 —Ç–æ–Ω–Ω</p>
                        <p class="product-price">45 000 —Ä—É–±./—Ç–æ–Ω–Ω–∞</p>
                        <button class="btn btn-cart add-to-cart"
                                data-id="1"
                                data-name="–ê—Ä–º–∞—Ç—É—Ä–∞ A500"
                                data-price="45000"
                                data-image="https://via.placeholder.com/300x200?text=–ê—Ä–º–∞—Ç—É—Ä–∞+A500">
                            –í –∫–æ—Ä–∑–∏–Ω—É
                        </button>
                    </div>
                </div>

                <!-- –¢–æ–≤–∞—Ä 2 -->
                <div class="product-card">
                    <div class="product-image">
                        <img src="https://via.placeholder.com/300x200?text=–õ–∏—Å—Ç+—Å—Ç–∞–ª—å–Ω–æ–π" alt="–õ–∏—Å—Ç —Å—Ç–∞–ª—å–Ω–æ–π">
                    </div>
                    <div class="product-info">
                        <h3 class="product-title">–õ–∏—Å—Ç —Å—Ç–∞–ª—å–Ω–æ–π</h3>
                        <p>–¢–æ–ª—â–∏–Ω–∞: 2-20 –º–º</p>
                        <p class="product-stock">–í –Ω–∞–ª–∏—á–∏–∏: 80 —Ç–æ–Ω–Ω</p>
                        <p class="product-price">52 000 —Ä—É–±./—Ç–æ–Ω–Ω–∞</p>
                        <button class="btn btn-cart add-to-cart"
                                data-id="2"
                                data-name="–õ–∏—Å—Ç —Å—Ç–∞–ª—å–Ω–æ–π"
                                data-price="52000"
                                data-image="https://via.placeholder.com/300x200?text=–õ–∏—Å—Ç+—Å—Ç–∞–ª—å–Ω–æ–π">
                            –í –∫–æ—Ä–∑–∏–Ω—É
                        </button>
                    </div>
                </div>

                <!-- –¢–æ–≤–∞—Ä 3 -->
                <div class="product-card">
                    <div class="product-image">
                        <img src="https://via.placeholder.com/300x200?text=–¢—Ä—É–±–∞+–∫—Ä—É–≥–ª–∞—è" alt="–¢—Ä—É–±–∞ –∫—Ä—É–≥–ª–∞—è">
                    </div>
                    <div class="product-info">
                        <h3 class="product-title">–¢—Ä—É–±–∞ –∫—Ä—É–≥–ª–∞—è</h3>
                        <p>–î–∏–∞–º–µ—Ç—Ä: 20-200 –º–º</p>
                        <p class="product-stock">–í –Ω–∞–ª–∏—á–∏–∏: 60 —Ç–æ–Ω–Ω</p>
                        <p class="product-price">68 000 —Ä—É–±./—Ç–æ–Ω–Ω–∞</p>
                        <button class="btn btn-cart add-to-cart"
                                data-id="3"
                                data-name="–¢—Ä—É–±–∞ –∫—Ä—É–≥–ª–∞—è"
                                data-price="68000"
                                data-image="https://via.placeholder.com/300x200?text=–¢—Ä—É–±–∞+–∫—Ä—É–≥–ª–∞—è">
                            –í –∫–æ—Ä–∑–∏–Ω—É
                        </button>
                    </div>
                </div>

                <!-- –¢–æ–≤–∞—Ä 4 -->
                <div class="product-card">
                    <div class="product-image">
                        <img src="https://via.placeholder.com/300x200?text=–£–≥–æ–ª–æ–∫+–º–µ—Ç–∞–ª–ª–∏—á–µ—Å–∫–∏–π" alt="–£–≥–æ–ª–æ–∫ –º–µ—Ç–∞–ª–ª–∏—á–µ—Å–∫–∏–π">
                    </div>
                    <div class="product-info">
                        <h3 class="product-title">–£–≥–æ–ª–æ–∫ –º–µ—Ç–∞–ª–ª–∏—á–µ—Å–∫–∏–π</h3>
                        <p>–†–∞–∑–º–µ—Ä: 25x25 - 100x100 –º–º</p>
                        <p class="product-stock">–í –Ω–∞–ª–∏—á–∏–∏: 45 —Ç–æ–Ω–Ω</p>
                        <p class="product-price">48 000 —Ä—É–±./—Ç–æ–Ω–Ω–∞</p>
                        <button class="btn btn-cart add-to-cart"
                                data-id="4"
                                data-name="–£–≥–æ–ª–æ–∫ –º–µ—Ç–∞–ª–ª–∏—á–µ—Å–∫–∏–π"
                                data-price="48000"
                                data-image="https://via.placeholder.com/300x200?text=–£–≥–æ–ª–æ–∫+–º–µ—Ç–∞–ª–ª–∏—á–µ—Å–∫–∏–π">
                            –í –∫–æ—Ä–∑–∏–Ω—É
                        </button>
                    </div>
                </div>

                <!-- –¢–æ–≤–∞—Ä 5 -->
                <div class="product-card">
                    <div class="product-image">
                        <img src="https://via.placeholder.com/300x200?text=–®–≤–µ–ª–ª–µ—Ä" alt="–®–≤–µ–ª–ª–µ—Ä">
                    </div>
                    <div class="product-info">
                        <h3 class="product-title">–®–≤–µ–ª–ª–µ—Ä</h3>
                        <p>–ù–æ–º–µ—Ä: 5-20</p>
                        <p class="product-stock">–í –Ω–∞–ª–∏—á–∏–∏: 30 —Ç–æ–Ω–Ω</p>
                        <p class="product-price">55 000 —Ä—É–±./—Ç–æ–Ω–Ω–∞</p>
                        <button class="btn btn-cart add-to-cart"
                                data-id="5"
                                data-name="–®–≤–µ–ª–ª–µ—Ä"
                                data-price="55000"
                                data-image="https://via.placeholder.com/300x200?text=–®–≤–µ–ª–ª–µ—Ä">
                            –í –∫–æ—Ä–∑–∏–Ω—É
                        </button>
                    </div>
                </div>

                <!-- –¢–æ–≤–∞—Ä 6 -->
                <div class="product-card">
                    <div class="product-image">
                        <img src="https://via.placeholder.com/300x200?text=–ü—Ä–æ–≤–æ–ª–æ–∫–∞" alt="–ü—Ä–æ–≤–æ–ª–æ–∫–∞">
                    </div>
                    <div class="product-info">
                        <h3 class="product-title">–ü—Ä–æ–≤–æ–ª–æ–∫–∞ –≤—è–∑–∞–ª—å–Ω–∞—è</h3>
                        <p>–î–∏–∞–º–µ—Ç—Ä: 1,2-4 –º–º</p>
                        <p class="product-stock">–í –Ω–∞–ª–∏—á–∏–∏: 15 —Ç–æ–Ω–Ω</p>
                        <p class="product-price">38 000 —Ä—É–±./—Ç–æ–Ω–Ω–∞</p>
                        <button class="btn btn-cart add-to-cart"
                                data-id="6"
                                data-name="–ü—Ä–æ–≤–æ–ª–æ–∫–∞ –≤—è–∑–∞–ª—å–Ω–∞—è"
                                data-price="38000"
                                data-image="https://via.placeholder.com/300x200?text=–ü—Ä–æ–≤–æ–ª–æ–∫–∞">
                            –í –∫–æ—Ä–∑–∏–Ω—É
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <section id="about">
            <h2>–û –Ω–∞—à–µ–π –∫–æ–º–ø–∞–Ω–∏–∏</h2>
            <p>–ú—ã –∑–∞–Ω–∏–º–∞–µ–º—Å—è –ø—Ä–æ–¥–∞–∂–µ–π –º–µ—Ç–∞–ª–ª–æ–ø—Ä–æ–∫–∞—Ç–∞ —É–∂–µ –±–æ–ª–µ–µ 15 –ª–µ—Ç. –ù–∞—à–∞ –∫–æ–º–ø–∞–Ω–∏—è –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —à–∏—Ä–æ–∫–∏–π –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç –º–µ—Ç–∞–ª–ª–∏—á–µ—Å–∫–∏—Ö –∏–∑–¥–µ–ª–∏–π –ø–æ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–º —Ü–µ–Ω–∞–º. –ú—ã —Ä–∞–±–æ—Ç–∞–µ–º –∫–∞–∫ —Å –∫—Ä—É–ø–Ω—ã–º–∏ –æ–ø—Ç–æ–≤—ã–º–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è–º–∏, —Ç–∞–∫ –∏ —Å —á–∞—Å—Ç–Ω—ã–º–∏ –∫–ª–∏–µ–Ω—Ç–∞–º–∏.</p>
            <p>–í—Å–µ –Ω–∞—à–∏ —Ç–æ–≤–∞—Ä—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –ì–û–°–¢–∞–º –∏ –∏–º–µ—é—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –∫–∞—á–µ—Å—Ç–≤–∞.</p>
        </section>
        <section id="contacts">
            <h2>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h2>
            <div class="contact-info">
                <p><strong>–ê–¥—Ä–µ—Å:</strong> –ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω–∞—è —É–ª–∏—Ü–∞, —Å2, —Å–µ–ª–æ –î—É–±—Ä–æ–≤–∏—á–∏, –î—É–±—Ä–æ–≤–∏—á–µ—Å–∫–æ–µ —Å–µ–ª—å—Å–∫–æ–µ –ø–æ—Å–µ–ª–µ–Ω–∏–µ, –†—è–∑–∞–Ω—Å–∫–∏–π —Ä–∞–π–æ–Ω </p>
                <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> +7 (495) 123-45-67</p>
                <p><strong>Email:</strong> info@metalloprokat.ru</p>
                <p><strong>–†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã:</strong> –ü–Ω-–ü—Ç: 9:00-18:00, –°–±: 10:00-15:00, –í—Å: –≤—ã—Ö–æ–¥–Ω–æ–π</p>
            </div>

            <div class="map-container">
                <iframe src="https://yandex.ru/map-widget/v1/?um=constructor%3A1a2b3c4d5e6f7g8h9i0j1k2l3m4n5o6p7&amp;source=constructor" width="100%" height="100%" frameborder="0"></iframe>
            </div>
        </section>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–æ—Ä–∑–∏–Ω—ã -->
    <div id="cartModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞</h2>
            <div id="cartContent">
                <!-- –°—é–¥–∞ –±—É–¥–µ—Ç –≤—Å—Ç–∞–≤–ª–µ–Ω–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ—Ä–∑–∏–Ω—ã -->
                <div class="cart-empty">
                    <p>–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>
                    <button class="btn continue-shopping">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–∫–∞–∑–∞ -->
    <div id="orderModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h2>
            <div class="order-info" id="selectedProductInfo">
                <!-- –°—é–¥–∞ –±—É–¥–µ—Ç –≤—Å—Ç–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–∫–∞–∑–µ -->
            </div>
            <form id="orderForm">
                <div class="form-group">
                    <label for="name">–í–∞—à–µ –∏–º—è:</label>
                    <input type="text" id="name" name="name" required>
                </div>
                <div class="form-group">
                    <label for="phone">–¢–µ–ª–µ—Ñ–æ–Ω:</label>
                    <input type="tel" id="phone" name="phone" required>
                </div>
                <div class="form-group">
                    <label for="email">Email:</label>
                    <input type="email" id="email" name="email">
                </div>
                <div class="form-group">
                    <label for="delivery">–°–ø–æ—Å–æ–± –ø–æ–ª—É—á–µ–Ω–∏—è:</label>
                    <select id="delivery" name="delivery">
                        <option value="pickup">–°–∞–º–æ–≤—ã–≤–æ–∑</option>
                        <option value="delivery">–î–æ—Å—Ç–∞–≤–∫–∞</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="address">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è):</label>
                    <input type="text" id="address" name="address">
                </div>
                <div class="form-group">
                    <label for="message">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</label>
                    <textarea id="message" name="message"></textarea>
                </div>
                <button type="submit" class="submit-btn">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–∫–∞–∑</button>
            </form>
        </div>
    </div>

    <footer>
        <p>&copy; 2025 –ú–µ—Ç–∞–ª–ª–ü—Ä–æ–∫–∞—Ç. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
    </footer>

    <script>
        // –ö–æ—Ä–∑–∏–Ω–∞
        let cart = [];
        const cartButton = document.getElementById("cartButton");
        const cartCount = document.getElementById("cartCount");
        const cartModal = document.getElementById("cartModal");
        const cartContent = document.getElementById("cartContent");
        const orderModal = document.getElementById("orderModal");
        const orderForm = document.getElementById("orderForm");
        const closeButtons = document.querySelectorAll(".close");

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã –∏–∑ localStorage
        function loadCart() {
            const savedCart = localStorage.getItem('cart');
            if (savedCart) {
                cart = JSON.parse(savedCart);
                updateCartCount();
            }
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω—ã –≤ localStorage
        function saveCart() {
            localStorage.setItem('cart', JSON.stringify(cart));
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã
        function updateCartCount() {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            cartCount.textContent = totalItems;
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –∫–æ—Ä–∑–∏–Ω—ã –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
        function updateCartContent() {
            if (cart.length === 0) {
                cartContent.innerHTML = `
                    <div class="cart-empty">
                        <p>–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>
                        <button class="btn continue-shopping">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏</button>
                    </div>
                `;
            } else {
                let tableHTML = `
                    <table class="cart-table">
                        <thead>
                            <tr>
                                <th>–¢–æ–≤–∞—Ä</th>
                                <th>–¶–µ–Ω–∞</th>
                                <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                                <th>–°—É–º–º–∞</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                `;

                let total = 0;

                cart.forEach((item, index) => {
                    const itemTotal = item.price * item.quantity;
                    total += itemTotal;

                    tableHTML += `
                        <tr>
                            <td>
                                <img src="${item.image}" alt="${item.name}" style="width:50px; height:auto; margin-right:10px;">
                                ${item.name}
                            </td>
                            <td>${item.price.toLocaleString()} —Ä—É–±.</td>
                            <td>
                                <input type="number" class="quantity-input"
                                       value="${item.quantity}" min="1"
                                       data-index="${index}">
                            </td>
                            <td>${itemTotal.toLocaleString()} —Ä—É–±.</td>
                            <td class="remove-btn" data-index="${index}">√ó</td>
                        </tr>
                    `;
                });

                tableHTML += `
                        </tbody>
                    </table>
                    <div class="cart-total">
                        –ò—Ç–æ–≥–æ: ${total.toLocaleString()} —Ä—É–±.
                    </div>
                    <div class="cart-actions">
                        <button class="btn continue-shopping">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏</button>
                        <button class="btn checkout-btn" id="checkoutButton">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
                    </div>
                `;

                cartContent.innerHTML = tableHTML;

                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –Ω–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
                document.querySelectorAll('.quantity-input').forEach(input => {
                    input.addEventListener('change', function() {
                        const index = this.getAttribute('data-index');
                        const newQuantity = parseInt(this.value);
                        if (newQuantity > 0) {
                            cart[index].quantity = newQuantity;
                            saveCart();
                            updateCartContent();
                            updateCartCount();
                        }
                    });
                });

                document.querySelectorAll('.remove-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const index = this.getAttribute('data-index');
                        cart.splice(index, 1);
                        saveCart();
                        updateCartContent();
                        updateCartCount();
                    });
                });

                document.getElementById('checkoutButton').addEventListener('click', function() {
                    cartModal.style.display = 'none';
                    showOrderModal();
                });
            }

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏"
            document.querySelectorAll('.continue-shopping').forEach(btn => {
                btn.addEventListener('click', function() {
                    cartModal.style.display = 'none';
                });
            });
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–∫–∞–∑–∞
        function showOrderModal() {
            let orderInfoHTML = '<h3>–°–æ—Å—Ç–∞–≤ –∑–∞–∫–∞–∑–∞:</h3><ul>';
            let total = 0;

            cart.forEach(item => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                orderInfoHTML += `<li>${item.name} - ${item.quantity} —Ç–æ–Ω–Ω √ó ${item.price.toLocaleString()} —Ä—É–±. = ${itemTotal.toLocaleString()} —Ä—É–±.</li>`;
            });

            orderInfoHTML += `</ul><p><strong>–û–±—â–∞—è —Å—É–º–º–∞: ${total.toLocaleString()} —Ä—É–±.</strong></p>`;
            document.getElementById('selectedProductInfo').innerHTML = orderInfoHTML;
            orderModal.style.display = 'block';
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –≤ –∫–æ—Ä–∑–∏–Ω—É
        document.querySelectorAll('.add-to-cart').forEach(button => {
            button.addEventListener('click', function() {
                const id = this.getAttribute('data-id');
                const name = this.getAttribute('data-name');
                const price = parseInt(this.getAttribute('data-price'));
                const image = this.getAttribute('data-image');

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ —Ç–∞–∫–æ–π —Ç–æ–≤–∞—Ä –≤ –∫–æ—Ä–∑–∏–Ω–µ
                const existingItem = cart.find(item => item.id === id);

                if (existingItem) {
                    existingItem.quantity += 1;
                } else {
                    cart.push({
                        id,
                        name,
                        price,
                        image,
                        quantity: 1
                    });
                }

                saveCart();
                updateCartCount();

                // –ê–Ω–∏–º–∞—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ—Ä–∑–∏–Ω—É
                const cartBtnRect = cartButton.getBoundingClientRect();
                const buttonRect = this.getBoundingClientRect();

                const flyingItem = document.createElement('div');
                flyingItem.style.position = 'fixed';
                flyingItem.style.left = `${buttonRect.left}px`;
                flyingItem.style.top = `${buttonRect.top}px`;
                flyingItem.style.width = '20px';
                flyingItem.style.height = '20px';
                flyingItem.style.backgroundColor = '#27ae60';
                flyingItem.style.borderRadius = '50%';
                flyingItem.style.zIndex = '1000';
                flyingItem.style.transition = 'all 0.5s ease-out';
                document.body.appendChild(flyingItem);

                setTimeout(() => {
                    flyingItem.style.left = `${cartBtnRect.left}px`;
                    flyingItem.style.top = `${cartBtnRect.top}px`;
                    flyingItem.style.transform = 'scale(0.2)';
                    flyingItem.style.opacity = '0.5';
                }, 10);

                setTimeout(() => {
                    document.body.removeChild(flyingItem);
                }, 600);
            });
        });

        // –û—Ç–∫—Ä—ã—Ç–∏–µ –∫–æ—Ä–∑–∏–Ω—ã
        cartButton.addEventListener('click', function() {
            updateCartContent();
            cartModal.style.display = 'block';
        });

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
        closeButtons.forEach(btn => {
            btn.addEventListener('click', function() {
                cartModal.style.display = 'none';
                orderModal.style.display = 'none';
            });
        });

        window.addEventListener('click', function(event) {
            if (event.target == cartModal) {
                cartModal.style.display = 'none';
            }
            if (event.target == orderModal) {
                orderModal.style.display = 'none';
            }
        });

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞
        orderForm.addEventListener('submit', function(e) {
            e.preventDefault();

            // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã
            const formData = new FormData(this);
            const orderData = {
                customer: {
                    name: formData.get('name'),
                    phone: formData.get('phone'),
                    email: formData.get('email'),
                    delivery: formData.get('delivery'),
                    address: formData.get('address'),
                    message: formData.get('message')
                },
                items: cart,
                total: cart.reduce((sum, item) => sum + (item.price * item.quantity), 0),
                date: new Date().toISOString()
            };

            // –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä
            // –ù–∞–ø—Ä–∏–º–µ—Ä, —Å –ø–æ–º–æ—â—å—é fetch –∏–ª–∏ XMLHttpRequest

            // –í –¥–∞–Ω–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ –ø—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
            alert(`–°–ø–∞—Å–∏–±–æ –∑–∞ –∑–∞–∫–∞–∑, ${orderData.customer.name}!\n\n–ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.`);

            // –û—á–∏—â–∞–µ–º –∫–æ—Ä–∑–∏–Ω—É
            cart = [];
            saveCart();
            updateCartCount();

            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            orderModal.style.display = 'none';

            // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
            this.reset();
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            loadCart();
        });
    </script>
     <script>
        // –ó–∞—â–∏—Ç–∞ –æ—Ç XSS
        function escapeHtml(unsafe) {
            return unsafe.toString()
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }

        // CSRF-—Ç–æ–∫–µ–Ω
        let csrfToken = generateCsrfToken();

        function generateCsrfToken() {
            const array = new Uint32Array(10);
            window.crypto.getRandomValues(array);
            return array.join('');
        }

        // –ó–∞—â–∏—â–µ–Ω–Ω–∞—è –∫–æ—Ä–∑–∏–Ω–∞
        class SecureCart {
            constructor() {
                this.cart = [];
                this.loadCart();
            }

            loadCart() {
                try {
                    const savedCart = localStorage.getItem('secureCart');
                    if (savedCart) {
                        // –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∫–æ—Ä–∑–∏–Ω—ã
                        const parsed = JSON.parse(savedCart);
                        if (Array.isArray(parsed) {
                            this.cart = parsed.filter(item =>
                                item.id &&
                                item.name &&
                                typeof item.price === 'number' &&
                                typeof item.quantity === 'number' &&
                                item.price > 0 &&
                                item.quantity > 0
                            );
                        }
                    }
                } catch (e) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ—Ä–∑–∏–Ω—ã:', e);
                    this.cart = [];
                }
            }

            saveCart() {
                try {
                    localStorage.setItem('secureCart', JSON.stringify(this.cart));
                } catch (e) {
                    console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ—Ä–∑–∏–Ω—ã:', e);
                }
            }

            addItem(item) {
                // –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
                if (!item || !item.id || !item.name || typeof item.price !== 'number' || item.price <= 0) {
                    throw new Error('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä–∞');
                }

                const existingItem = this.cart.find(i => i.id === item.id);
                if (existingItem) {
                    existingItem.quantity += 1;
                } else {
                    this.cart.push({
                        id: escapeHtml(item.id),
                        name: escapeHtml(item.name),
                        price: Number(item.price),
                        image: item.image.startsWith('https://') ? item.image : '',
                        quantity: 1
                    });
                }
                this.saveCart();
            }

            removeItem(index) {
                if (index >= 0 && index < this.cart.length) {
                    this.cart.splice(index, 1);
                    this.saveCart();
                }
            }

            updateQuantity(index, quantity) {
                if (index >= 0 && index < this.cart.length) {
                    const qty = Number(quantity);
                    if (qty > 0 && qty < 1000) { // —Ä–∞–∑—É–º–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
                        this.cart[index].quantity = qty;
                        this.saveCart();
                    }
                }
            }

            getTotalItems() {
                return this.cart.reduce((sum, item) => sum + item.quantity, 0);
            }

            getTotalPrice() {
                return this.cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            }

            clear() {
                this.cart = [];
                this.saveCart();
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞—â–∏—â–µ–Ω–Ω–æ–π –∫–æ—Ä–∑–∏–Ω—ã
        const secureCart = new SecureCart();

        // –ó–∞—â–∏—â–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã
        function setupSecureForm() {
            const orderForm = document.getElementById('orderForm');
            if (orderForm) {
                orderForm.addEventListener('submit', async function(e) {
                    e.preventDefault();

                    // –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã
                    const name = escapeHtml(this.name.value.trim());
                    const phone = escapeHtml(this.phone.value.trim());
                    const email = escapeHtml(this.email.value.trim());
                    const delivery = escapeHtml(this.delivery.value);
                    const address = escapeHtml(this.address.value.trim());
                    const message = escapeHtml(this.message.value.trim());

                    if (!name || !phone) {
                        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è');
                        return;
                    }

                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
                    if (!/^[\d\s\-\+\(\)]{10,20}$/.test(phone)) {
                        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞');
                        return;
                    }

                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ email (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω)
                    if (email && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email');
                        return;
                    }

                    // –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–∞
                    const orderData = {
                        customer: { name, phone, email, delivery, address, message },
                        items: secureCart.cart,
                        total: secureCart.getTotalPrice(),
                        date: new Date().toISOString(),
                        csrfToken
                    };

                    try {
                        // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç fetch-–∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É
                        // —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π CSRF-—Ç–æ–∫–µ–Ω–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
                        console.log('–û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–∫–∞–∑–∞:', orderData);

                        // –≠–º—É–ª—è—Ü–∏—è —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏
                        alert(`–°–ø–∞—Å–∏–±–æ –∑–∞ –∑–∞–∫–∞–∑, ${name}!\n\n–ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.`);

                        // –û—á–∏—Å—Ç–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞
                        secureCart.clear();
                        updateCartCount();
                        orderModal.style.display = 'none';
                        this.reset();
                    } catch (error) {
                        console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–∫–∞–∑–∞:', error);
                        alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.');
                    }
                });
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            updateCartCount();
            setupSecureForm();

            // –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ "–í –∫–æ—Ä–∑–∏–Ω—É"
            document.querySelectorAll('.add-to-cart').forEach(button => {
                button.addEventListener('click', function() {
                    try {
                        secureCart.addItem({
                            id: this.getAttribute('data-id'),
                            name: this.getAttribute('data-name'),
                            price: parseInt(this.getAttribute('data-price')),
                            image: this.getAttribute('data-image')
                        });
                        updateCartCount();
                        animateAddToCart(this);
                    } catch (error) {
                        console.error('–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ—Ä–∑–∏–Ω—É:', error);
                    }
                });
            });
        });

        // –û—Å—Ç–∞–ª—å–Ω—ã–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–∞–Ω–∏–º–∞—Ü–∏–∏, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞)
        function updateCartCount() {
            cartCount.textContent = secureCart.getTotalItems();
        }

    </script>

</body>
</html>